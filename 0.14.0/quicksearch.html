<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Documentation Modules opossum Classes CircuitBreakerStatus Events CircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:successCircuitBreaker#event:timeout Modules Classes CircuitBreaker Status Events close Emitted when the breaker is reset allowing the action to execute again failure Emitted when the breaker action fails fallback Emitted when the breaker executes a fallback function fire Emitted when the breaker action is executed halfOpen Emitted after options.resetTimeout has elapsed, allowing for a single attempt to call the service again. If that attempt is successful, the circuit will be closed. Otherwise it remains open. open Emitted when the breaker action fails more than options.maxFailures reject Emitted when the breaker is open and failing fast success Emitted when the breaker action succeeds timeout Emitted when the breaker action takes longer than options.timeout × Search results Close Documentation generated by JSDoc 3.4.3 on 2016-12-23T01:12:28-05:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Modules opossum Classes CircuitBreakerStatus Events CircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:successCircuitBreaker#event:timeout Classes Classes CircuitBreaker Status Events close Emitted when the breaker is reset allowing the action to execute again failure Emitted when the breaker action fails fallback Emitted when the breaker executes a fallback function fire Emitted when the breaker action is executed halfOpen Emitted after options.resetTimeout has elapsed, allowing for a single attempt to call the service again. If that attempt is successful, the circuit will be closed. Otherwise it remains open. open Emitted when the breaker action fails more than options.maxFailures reject Emitted when the breaker is open and failing fast success Emitted when the breaker action succeeds timeout Emitted when the breaker action takes longer than options.timeout × Search results Close Documentation generated by JSDoc 3.4.3 on 2016-12-23T01:12:28-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Modules opossum Classes CircuitBreakerStatus Events CircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:successCircuitBreaker#event:timeout opossum Opossum is a Node.js circuit breaker that executes asynchronous functions and monitors their execution status. When things start failing, opossum plays dead and fails fast. If you want, you can provide a fallback function to be executed when in the failure state. For more about the circuit breaker pattern, there are lots of resources on the web - search it! Fowler's blog post is one place to start reading. Project Info License: Apache-2.0 Build: make Documentation: https://bucharest-gold.github.io/opossum/ Issue tracker: https://github.com/bucharest-gold/opossum/issues Engines: Node.js 4.x, 5.x, 6.x, 7.x UsageLet's say you've got an API that depends on something that might fail - a network operation, or disk read, for example. Wrap those functions up in a CircuitBreaker and you have control over your destiny. const circuitBreaker = require('opossum'); function asyncFunctionThatCouldFail (x, y) { return new Promise((resolve, reject) =&gt; { // Do something, maybe on the network or a disk }); } const options = { timeout: 3000, // If our function takes longer than 3 seconds, trigger a failure maxFailures: 5, // Once we fail this many times in a row, start failing fast resetTimeout: 30000 // After 30 seconds, try again. }; const breaker = circuitBreaker(asyncFunctionThatCouldFail, options); breaker.fire(params) .then(console.log) .catch(console.error);FallbackYou can also provide a fallback function that will be executed in the event of failure. To take some action when the fallback is performed, listen for the fallback event. const breaker = circuitBreaker(asyncFunctionThatCouldFail, options); // if asyncFunctionThatCouldFail starts to fail, firing the breaker // will trigger our fallback function breaker.fallback(() =&gt; 'Sorry, out of service right now'); breaker.on('fallback', (result) =&gt; reportFallbackEvent(result));Once the circuit has opened, a timeout is set based on options.resetTimeout. When the resetTimeout expires, opossum will enter the halfOpen state and try the action again. If successful, the circuit will close and emit the close event. When a fallback function is triggered, it's considered a failure, and the fallback function will continue to be executed until the breaker is closed. BrowserOpossum really shines in a browser. You can use it to guard against network failures in your AJAX calls. A browserified version of the module is available as a compressed file, or exploded in the dist folder. Here is an example using hapi.js. See the examples folder for more detail. Include opossum.js in your HTML file. &lt;html&gt; &lt;head&gt; &lt;title&gt;My Super App&lt;/title&gt; &lt;script type='text/javascript' src=&quot;/jquery.js&quot;&gt;&lt;/script&gt; &lt;script type='text/javascript' src=&quot;/opossum.js&quot;&gt;&lt;/script&gt; &lt;script type='text/javascript' src=&quot;/app.js&quot;&gt;&lt;/script&gt; &lt;body&gt; ... &lt;/body&gt; &lt;/head&gt; &lt;/html&gt;In your application, set a route to the file, pointing to node_modules/opossum/dist/opossum-min.js. // server.js const server = new Hapi.Server(); server.register(require('inert', (err) =&gt; possibleError(err))); server.route({ method: 'GET', path: '/opossum.js', handler: { file: { path: path.join(__dirname, 'node_modules', 'opossum', 'dist', 'opossum-min.js'), } } });In the browser's global scope will be a circuitBreaker function. Use it to create circuit breakers, guarding against network failures in your REST API calls. // app.js const route = 'https://example-service.com/rest/route'; const circuitBreakerOptions = { timeout: 500, maxFailures: 3, resetTimeout: 5000 }; const circuit = circuitBreaker(() =&gt; $.get(route), circuitBreakerOptions); circuit.fallback(() =&gt; `${route} unavailable right now. Try later.`)); circuit.on('success', (result) =&gt; $(element).append(JSON.stringify(result)})); $(() =&gt; { $('#serviceButton').click(() =&gt; circuit.fire().catch((e) =&gt; console.error(e))); });EventsA CircuitBreaker will emit events for important things that occur. Here are the events you can listen for. fire - emitted when the breaker is fired. reject - emitted when the breaker is open (or halfOpen). timeout - emitted when the breaker action times out. success - emitted when the breaker action completes successfully failure - emitted when the breaker action fails, called with the error open - emitted when the breaker state changes to open close - emitted when the breaker state changes to closed halfOpen - emitted when the breaker state changes to halfOpen fallback - emitted when the breaker has a fallback function and executes it Handling events gives a greater level of control over your application behavior. const circuit = circuitBreaker(() =&gt; $.get(route), circuitBreakerOptions); circuit.fallback(() =&gt; ({ body: `${route} unavailable right now. Try later.` })); circuit.on('success', (result) =&gt; $(element).append( makeNode(`SUCCESS: ${JSON.stringify(result)}`))); circuit.on('timeout', () =&gt; $(element).append( makeNode(`TIMEOUT: ${route} is taking too long to respond.`))); circuit.on('reject', () =&gt; $(element).append( makeNode(`REJECTED: The breaker for ${route} is open. Failing fast.`))); circuit.on('open', () =&gt; $(element).append( makeNode(`OPEN: The breaker for ${route} just opened.`))); circuit.on('halfOpen', () =&gt; $(element).append( makeNode(`HALF_OPEN: The breaker for ${route} is half open.`))); circuit.on('close', () =&gt; $(element).append( makeNode(`CLOSE: The breaker for ${route} has closed. Service OK.`))); circuit.on('fallback', (data) =&gt; $(element).append( makeNode(`FALLBACK: ${JSON.stringify(data)}`)));Promises vs. CallbacksThe opossum API returns a Promise from CircuitBreaker.fire(). But your circuit action - the async function that might fail - doesn't have to return a promise. You can easily turn Node.js style callback functions into something opossum understands by using circuitBreaker.promisify(). const fs = require('fs'); const circuitBreaker = require('opossum'); const readFile = circuitBreaker.promisify(fs.readFile); const breaker = circuitBreaker(readFile, options); breaker.fire('./package.json', 'utf-8') .then(console.log) .catch(console.error);And just for fun, your circuit doesn't even really have to be a function. Not sure when you'd use this - but you could if you wanted to. const breaker = circuitBreaker('foo', options); breaker.fire() .then(console.log) // logs 'foo' .catch(console.error);Promise InteroperabilityThe Promise implementation used in opossum is compliant with both the ES6 Promise API as well as the promises/A+ API. This means that it doesn't matter what flavor of promise your API uses, opossum should work fine with it. If you would like to control what Promise implementation used in opossum, provide a Promise constructor function in your options when you create the breaker. E.g. // Force opossum to use native JS promises const breaker = circuitBreaker(readFile, { Promise: Promise }); × Search results Close Documentation generated by JSDoc 3.4.3 on 2016-12-23T01:12:28-05:00 using the DocStrap template. "},"CircuitBreaker.html":{"id":"CircuitBreaker.html","title":"Class: CircuitBreaker","body":" Documentation Modules opossum Classes CircuitBreakerStatus Events CircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:successCircuitBreaker#event:timeout Class: CircuitBreaker CircuitBreaker new CircuitBreaker(action, options) Parameters: Name Type Description action function The action to fire for this CircuitBreaker instance options Object Options for the CircuitBreaker. There are **no default options** when you use the contructor directly. You must supply values for each of these. Properties Name Type Description timeout number The time in milliseconds that action should be allowed to execute before timing out. maxFailures The number of times the circuit can fail before opening. resetTimeout The time in milliseconds to wait before setting the breaker to `halfOpen` state, and trying the action again. Fires: CircuitBreaker#event:halfOpen Extends EventEmitter Members closed True if the circuit is currently closed. False otherwise. halfOpen True if the circuit is currently half opened. False otherwise. opened True if the circuit is currently opened. False otherwise. status The current Status of this CircuitBreaker Methods close() Closes the breaker, allowing the action to execute again Fires: CircuitBreaker#event:close fallback(func) Provide a fallback function for this CircuitBreaker. This function will be executed when the breaker opens, instead of returning a rejected Promise. Parameters: Name Type Description func function | CircuitBreaker the fallback function to execute when the breaker has opened or when a timeout or error occurs. Returns: CircuitBreaker this fire() Execute the action for this circuit. If the action fails or times out, the returned promise will be rejected. If the action succeeds, the promise will resolve with the resolved value from action. Fires: CircuitBreaker#event:failure CircuitBreaker#event:fallback CircuitBreaker#event:fire CircuitBreaker#event:reject CircuitBreaker#event:success CircuitBreaker#event:timeout Returns: Promise a Promise that resolves on success and is rejected on failure of the action. open() Opens the breaker, returning a failed Promise each time the breaker is fired, or falling back to any fallback function that has been provided. Fires: CircuitBreaker#event:open Events close Emitted when the breaker is reset allowing the action to execute again failure Emitted when the breaker action fails fallback Emitted when the breaker executes a fallback function fire Emitted when the breaker action is executed halfOpen Emitted after options.resetTimeout has elapsed, allowing for a single attempt to call the service again. If that attempt is successful, the circuit will be closed. Otherwise it remains open. open Emitted when the breaker action fails more than options.maxFailures reject Emitted when the breaker is open and failing fast success Emitted when the breaker action succeeds timeout Emitted when the breaker action takes longer than options.timeout × Search results Close Documentation generated by JSDoc 3.4.3 on 2016-12-23T01:12:28-05:00 using the DocStrap template. "},"module-opossum.html":{"id":"module-opossum.html","title":"Module: opossum","body":" Documentation Modules opossum Classes CircuitBreakerStatus Events CircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:successCircuitBreaker#event:timeout Module: opossum Methods &lt;inner&gt; circuitBreaker(action, options) Creates a CircuitBreaker instance capable of executing `action`. Parameters: Name Type Description action function The action to fire for this CircuitBreaker instance options Object Options for the CircuitBreaker Properties Name Type Description timeout number The time in milliseconds that action should be allowed to execute before timing out. Default 10000 (10 seconds) maxFailures The number of times the circuit can fail before opening. Default 10. resetTimeout The time in milliseconds to wait before setting the breaker to `halfOpen` state, and trying the action again. Promise Promise Opossum uses Fidelity promises, but works fine with any Promise that follows the spec. You can specify your favored implementation by providing the constructor as an option. Returns: a CircuitBreaker instance &lt;inner&gt; promisify(action) Given a function that receives a callback as its last argument, and which executes that function, passing as parameters `err` and `result`, creates an action that returns a promise which resolves when the function's callback is executed. Parameters: Name Type Description action function A Node.js-like asynchronous function Returns: The `action` wrapped in a promise API. Example const fs = require('fs'); const readFilePromised = circuitBreaker.promisify(fs.readFile); const breaker = circuitBreaker(readFilePromised); × Search results Close Documentation generated by JSDoc 3.4.3 on 2016-12-23T01:12:28-05:00 using the DocStrap template. "},"Status.html":{"id":"Status.html","title":"Class: Status","body":" Documentation Modules opossum Classes CircuitBreakerStatus Events CircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:successCircuitBreaker#event:timeout Class: Status Status Tracks execution status for a given CircuitBreaker new Status(circuit) Parameters: Name Type Description circuit CircuitBreaker the CircuitBreaker to track status for Members failures The number of times the breaker's action has failed fallbacks The number of times a fallback function has been executed fires The number of times this circuit breaker has been fired rejects The number of times this breaker been rejected because it was fired, but in the open state. successes The number of times the action for this breaker executed successfully timeouts The number of times this circuit breaker has timed out × Search results Close Documentation generated by JSDoc 3.4.3 on 2016-12-23T01:12:28-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
